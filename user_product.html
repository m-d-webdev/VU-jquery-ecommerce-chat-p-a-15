<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style_user_prd.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous">
        </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <!-- font-family: "Kanit", sans-serif; -->
</head>


<body>
    <div class="cnt_product">
        <p class="descriptionTEXT"></p>
        <div class="cntIMGPRODECT">
            <img src="" alt="">
        </div>
        <span>
            <img src="img/price-tag.png" alt="">
            <p class="price"></p>
        </span>
        <span>
            <img src="img/pin.png" alt="">
            <a target="_blank" href="" class="adress"></a>
        </span>
        <p class="date_save"></p>
    </div>
    <div class="no_resu">
        <span>Alt + <- to back</span>
                <p>No product Founded</p>
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="934.98"
                    height="571.14" viewBox="0 0 934.98 571.14">
                    <path
                        d="m733.52,89.21s-20.58,2.32-21.91,34.19c-1.11,26.56-3.37,41.36,7.44,46.9,3.86,1.98,8.4,2.15,12.53.8l44.1-14.5s.66-47.8-14.61-59.42-27.55-7.97-27.55-7.97h0Z"
                        fill="#36344e" stroke-width="0" />
                    <polygon points="757.83 162.46 735.51 169.8 735.51 137.67 755.76 137.67 757.83 162.46"
                        fill="#faafb2" stroke-width="0" />
                    <path id="uuid-ea0a1472-32fb-4242-948a-de51795c4bd3-46-44-46-72-78-43-43-46-48"
                        d="m689.6,344.84c-1.21,7.36-6.12,12.64-10.96,11.79-4.85-.85-7.79-7.51-6.58-14.87.44-2.95,1.61-5.74,3.4-8.13l5.53-31.12,15.05,3.15-7.05,30.34c.93,2.87,1.14,5.9.61,8.84h0Z"
                        fill="#faafb2" stroke-width="0" />
                    <polygon points="740.7 551.77 719.8 551.77 707.67 440.07 739.99 440.07 740.7 551.77" fill="#faafb2"
                        stroke-width="0" />
                    <path
                        d="m699.44,569.72c-2.2,0-4.16-.05-5.63-.19-5.55-.51-10.85-4.61-13.51-7-1.19-1.07-1.58-2.79-.96-4.27h0c.45-1.06,1.34-1.85,2.45-2.17l14.67-4.19,23.76-16.03.27.48c.1.18,2.43,4.38,3.21,7.22.3,1.08.22,1.98-.23,2.68-.31.48-.75.76-1.1.92.43.45,1.78,1.36,5.93,2.02,6.07.96,7.33-5.32,7.39-5.58l.04-.21.18-.12c2.88-1.86,4.66-2.7,5.27-2.52.38.11,1.02.31,2.74,17.41.17.54,1.38,4.47.56,8.24-.89,4.1-18.78,2.69-22.36,2.36-.1.01-13.49.96-22.67.96h-.01Z"
                        fill="#36344e" stroke-width="0" />
                    <polygon points="787.93 551.77 767.02 551.77 754.9 440.07 787.21 440.07 787.93 551.77"
                        fill="#faafb2" stroke-width="0" />
                    <path
                        d="m746.67,569.72c-2.2,0-4.16-.05-5.63-.19-5.55-.51-10.85-4.61-13.51-7-1.19-1.07-1.58-2.79-.96-4.27h0c.45-1.06,1.34-1.85,2.45-2.17l14.67-4.19,23.76-16.03.27.48c.1.18,2.43,4.38,3.21,7.22.3,1.08.22,1.98-.23,2.68-.31.48-.75.76-1.1.92.43.45,1.78,1.36,5.93,2.02,6.07.96,7.33-5.32,7.39-5.58l.04-.21.18-.12c2.89-1.86,4.66-2.7,5.27-2.52.38.11,1.02.31,2.74,17.41.17.54,1.38,4.47.56,8.24-.89,4.1-18.78,2.69-22.36,2.36-.1.01-13.49.96-22.67.96h-.01Z"
                        fill="#36344e" stroke-width="0" />
                    <polygon points="793.94 277.42 692.37 277.42 728.88 157.26 769.38 157.26 793.94 277.42"
                        fill="#dfdfe0" stroke-width="0" />
                    <path d="m735.27,157.27s-25.23-.66-27.88,5.98-33.86,164.65-33.86,164.65h20.58l41.16-170.62h0Z"
                        fill="#dfdfe0" stroke-width="0" />
                    <circle cx="738.27" cy="124.32" r="22.24" fill="#faafb2" stroke-width="0" />
                    <path
                        d="m732.19,97.51s-12.24,49.7,1.37,72.93l-19.17-4.07s-7.43-54.39,7.51-64.28c0,0,10.29-4.58,10.29-4.58Z"
                        fill="#36344e" stroke-width="0" />
                    <path
                        d="m772.83,277.42h-66.66l-36.47,149.69c-.67,6.32,3.34,12.22,9.48,13.87,20.01,5.36,68.03,12.95,140.7-8.2,6.99-2.03,10.96-9.41,8.77-16.36l-55.82-139h0Z"
                        fill="#36344e" stroke-width="0" />
                    <path
                        d="m745.88,157.26l20.73-.91c8.98.68,17.1,5.56,21.91,13.17,14.65,23.16,42.06,71.97,17.59,78.66-32.26,8.81-47.89-40.24-47.89-40.24l-12.34-50.68h0Z"
                        fill="#dfdfe0" stroke-width="0" />
                    <path id="uuid-298a271f-a3d1-4ea5-9ac1-ac2853dfa275-47-45-47-73-79-44-44-47-49"
                        d="m738.77,171.8c-4.26-6.12-4.41-13.33-.35-16.1,4.07-2.77,10.82-.04,15.08,6.08,1.74,2.42,2.84,5.24,3.22,8.2l17.71,26.18-12.99,8.23-16.08-26.68c-2.67-1.41-4.93-3.44-6.59-5.91h0Z"
                        fill="#faafb2" stroke-width="0" />
                    <polygon points="749.25 192.97 763.88 179.51 792.81 206.44 765.91 224.83 749.25 192.97"
                        fill="#dfdfe0" stroke-width="0" />
                    <path
                        d="m32.41,126.63h459.26c17.9,0,32.41,14.51,32.41,32.41h0c0,17.9-14.51,32.41-32.41,32.41H32.41c-17.9,0-32.41-14.51-32.41-32.41h0c0-17.9,14.51-32.41,32.41-32.41Z"
                        fill="#6c63ff" stroke-width="0" />
                    <path
                        d="m203.31,569.95c0,.66.53,1.19,1.19,1.19h729.29c.66,0,1.19-.53,1.19-1.19s-.53-1.19-1.19-1.19H204.5c-.66,0-1.19.53-1.19,1.19Z"
                        fill="#484565" stroke-width="0" />
                    <path
                        d="m424.62,93.95h95.35c2.28,0,4.12,1.84,4.12,4.11h0c0,2.27-1.84,4.11-4.12,4.11h-95.35c-2.28,0-4.12-1.84-4.12-4.11h0c0-2.27,1.84-4.11,4.12-4.11Z"
                        fill="#dfdfe0" stroke-width="0" />
                    <path
                        d="m4.12,0h95.35c2.28,0,4.12,1.84,4.12,4.11h0c0,2.27-1.84,4.11-4.12,4.11H4.12C1.84,8.23,0,6.39,0,4.11h0C0,1.84,1.84,0,4.12,0Z"
                        fill="#dfdfe0" stroke-width="0" />
                    <path
                        d="m4.12,35.91h279.87c2.28,0,4.12,1.84,4.12,4.12h0c0,2.27-1.84,4.11-4.12,4.11H4.12c-2.28,0-4.12-1.84-4.12-4.11h0c0-2.27,1.84-4.12,4.12-4.12Z"
                        fill="#dfdfe0" stroke-width="0" />
                    <path
                        d="m233.77,260.88c0,21.56,17.48,39.04,39.04,39.04,6.53,0,12.68-1.6,18.08-4.43l37.83,60c2.32,3.67,7.27,4.59,10.75,1.99h0c3.25-2.43,3.95-7.01,1.58-10.31l-41.61-57.75c7.63-7.13,12.41-17.28,12.41-28.54,0-21.56-17.48-39.04-39.04-39.04s-39.04,17.48-39.04,39.04Zm5.36,0c0-18.6,15.08-33.69,33.69-33.69s33.69,15.08,33.69,33.69c0,18.6-15.08,33.69-33.69,33.69-18.6,0-33.69-15.08-33.69-33.69Z"
                        fill="#484662" stroke-width="0" />
                </svg>
    </div>

    <main class="main_pag1">
        <div class="cnt_menu_prd">
            <buuton class="btn_type_prduct">
                All
            </buuton>
            <div class="list_btn">
                <button class="btn_all_svd">All</button>
                <button class="btn_op">Phones</button>
                <button class="btn_op">watches</button>
                <button class="btn_op">headphones</button>
                <button class="btn_op">Computers</button>
                <button class="btn_op">Computer attachments</button>
                <button class="btn_op">Screens</button>
                <button class="btn_op">clothes </button>
                <button class="btn_op">Women's Clothing</button>
                <button class="btn_op">pants</button>
                <button class="btn_op">Short pants</button>
                <button class="btn_op">shoes</button>
                <button class="btn_op">slippers</button>
                <button class="btn_op">women bags</button>
                <button class="btn_op">bags</button>
                <button class="btn_op">glasses</button>
                <button class="btn_op">Hats</button>

            </div>
            <div class="list_prduct">


            </div>

        </div>
        <div class="cnt_image_prd">
            <button class="btn_remove_img"><img src="img/cn1.png" alt=""></button>
            <img class="img_prd_er" src="" alt="">
        </div>

        <button class="btn_chose_prod">
            <img src="img2/box copy.png" class="dv_dfi" alt="">
        </button>
        <div class="cnt_prd_shared">

            <button id="rem_prod">Remove Product</button>
            <div class="info_prod1">
            </div>
            <div class="info_prod2">
                <p class="title_this">Description</p>
                <div class="input_box" contenteditable="true"> </div>
            </div>
            <div class="info_prod3">
                <div class="dv_price">
                    <label for="inp_prcie2" class="lbl_price">Price</label>
                    <input type="text" id="inp_prcie2" placeholder="">
                    <button id="save_price" class="btn_save_ch">Save</button>
                </div>
                <div class="dv_etat">
                    <select name="" id="etat_prd2">
                        <option value="new">New</option>
                        <option value="Lile_new">Usid-Like New</option>
                        <option value="good">Usid-Good</option>
                        <option value="fair">Usid-Fair</option>
                    </select>
                    <button id="save_etat" class="btn_save_ch">Save</button>
                </div>

                <div class="dv_adress">
                    <label for="inp_adress2" class="lbl_asdre">Adress</label>
                    <input type="text" id="inp_adress2" placeholder="">
                    <button id="save_adress" class="btn_save_ch">Save</button>

                </div>

                <div class="dv_dilevry">
                    <select name="" id="delivery">
                        <option value="">Delivery available</option>
                        <option value="">Delivery is available for free</option>
                        <option value="">Delivery is not available</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="confirm_delet">
            <div class="poup_conf">
                <p>Are you sure you want to remove image ?</p>
                <button id="btn_sure1">Sure</button>
                <button id="btn_cancel2">Cancel</button>
            </div>
        </div>
    </main>

    <script>

        let choose_prd_id;
        window.onload = () => {
            setTimeout(() => {
                all_type[0].click()
            }, 200);
            unstring_url();
        }
        var id_user;
        function unstring_url() {
            var id_url = window.location.search;
            id_user = id_url.substring(id_url.indexOf("=") + 1);
            id_user = decodeURIComponent(id_user);
            id_user = JSON.parse(id_user);

        }

        let list_prduct = document.querySelector(".list_prduct");
        let cnt_menu_prd = document.querySelector(".cnt_menu_prd");
        cnt_menu_prd.classList.add("display");

        let all_type = document.querySelectorAll(".list_btn button");
        var arr_typr = Array.from(all_type);
        all_type.forEach(s => {
            s.onclick = () => {
                list_btn2.classList.remove("display");
                btn_type_prduct.innerHTML = s.innerHTML;
                var s_index = arr_typr.indexOf(s);
                switch (s_index) {
                    case 0:
                        load_saved_prd("all");
                        break;
                    case 1:
                        load_saved_prd("phone");
                        break;

                    case 2:
                        load_saved_prd('watche');
                        break;

                    case 3:
                        load_saved_prd('headphone');
                        break;

                    case 4:
                        load_saved_prd('computer');
                        break;

                    case 5:
                        load_saved_prd('c_attachment');
                        break;

                    case 6:
                        load_saved_prd('screen');
                        break;

                    case 7:
                        load_saved_prd('clothe');

                        break;
                    case 8:
                        load_saved_prd('w_clothing');

                        break;

                    case 9:
                        load_saved_prd('pant');
                        break;

                    case 10:
                        load_saved_prd('s_pant');
                        break;

                    case 11:
                        load_saved_prd('shoe');
                        break;

                    case 12:
                        load_saved_prd('slipper');
                        break;

                    case 13:
                        load_saved_prd('w_bag');
                        break;

                    case 14:
                        load_saved_prd('bag');
                        break;

                    case 15:
                        load_saved_prd('glasse');
                        break;

                    case 16:
                        load_saved_prd('Hat');
                        break;

                }

            }
        })

        function load_saved_prd(typer) {
            choose_prd();
            // no_resitl_dv.classList.remove("display");
            list_prduct.replaceChildren();
            type_2 = typer;
            // let produts_active = main_prd.querySelectorAll('.cnt_product');
            // produts_active.forEach(cnt => cnt.remove())
            $(document).ready(
                function () {
                    $.post(
                        "load_own_pr.php", {
                        type: typer,
                        orderd: 'n_l',
                        id_user: id_user
                    }

                    ).done(
                        res => {
                            no_resu.classList.add("display")
                            res = JSON.parse(res);
                            console.log(res)

                            if (typeof (res) == 'object') {
                                if (res.length > 0) {
                                    main_pag1.classList.add("display");
                                    no_resu.classList.remove("display");
                                }

                                for (i of res) {
                                    var cloned_product = cnt_product.cloneNode(true);
                                    cloned_product.querySelector(".descriptionTEXT").innerHTML = i['description'];
                                    var arr_img_prd = i.des_img.substring(0, i.des_img.indexOf(","));
                                    cloned_product.querySelector(".price").innerHTML = i['price'] + ' $ ';
                                    cloned_product.querySelector(".adress").innerHTML = i['local_product'];
                                    cloned_product.id = i['id_product'];
                                    cloned_product.classList.add('display')
                                    if (arr_img_prd.length > 0) {
                                        cloned_product.querySelector(".cntIMGPRODECT img").src = arr_img_prd;

                                    } else {
                                        if (i.des_img == "") {
                                            cloned_product.querySelector(".cntIMGPRODECT img").src = 'img2/no-image.png';

                                        } else
                                            cloned_product.querySelector(".cntIMGPRODECT img").src = i.des_img;
                                    }
                                    list_prduct.appendChild(cloned_product);
                                    choose_prd()
                                }

                            }

                        }
                    )

                }
            )

        }

        let no_resu = document.querySelector(".no_resu");
        let main_pag1 = document.querySelector(".main_pag1");
        let cnt_prd_shared = document.querySelector(".cnt_prd_shared");
        let rem_prod = document.querySelector("#rem_prod");
        let input_box = document.querySelector(".input_box");
        let inp_prcie2 = document.querySelector("#inp_prcie2");
        let etat_prd2 = document.querySelector("#etat_prd2");
        let inp_adress2 = document.querySelector("#inp_adress2");
        let cnt_product = document.querySelector(".cnt_product");

        let btn_save_price = document.getElementById('save_price');
        let save_etat = document.getElementById('save_etat');
        let save_adress = document.getElementById('save_adress');

        rem_prod.addEventListener(('click'), () => {
            confirm_delet.classList.add("display");
            confirm_delet.querySelector("p").innerHTML = 'Are you sure you want to remove this product ?'
            btn_cancel2.onclick = () => confirm_delet.classList.remove("display");
            btn_sure1.onclick = () => {
                var value = "not_available";
                var item = 'available';
                confirm(item, value);
                confirm_delet.classList.remove("display");
            }

        })


        inp_prcie2.onchange = () => {
            btn_save_price.classList.add("display");
        }

        etat_prd2.onchange = () => {
            save_etat.classList.add("display");
        }

        inp_adress2.onchange = () => {
            save_adress.classList.add("display");
        }



        btn_save_price.onclick = () => {
            var value = inp_prcie2.value;
            var item = 'price';
            confirm(item, value);
            btn_save_price.classList.remove("display");
        }

        save_etat.onclick = () => {
            var value = etat_prd2.value;
            var item = 'statu_prd';
            confirm(item, value);
            save_etat.classList.remove("display");

        }

        save_adress.onclick = () => {
            var value = inp_adress2.value;
            var item = 'local_product';
            confirm(item, value);
            save_adress.classList.remove("display");
        }





        let list_btn2 = document.querySelector(".list_btn");
        let btn_type_prduct = document.querySelector(".btn_type_prduct");


        btn_type_prduct.addEventListener("click", () => {
            list_btn2.classList.add("display");
            window.onclick = (e) => {
                if (!list_btn2.contains(e.target) && !btn_type_prduct.contains(e.target)) {
                    list_btn2.classList.remove("display");

                }
            }
        })

        let confirm_delet = document.querySelector(".confirm_delet")
        let btn_sure1 = document.querySelector("#btn_sure1")
        let btn_cancel2 = document.querySelector("#btn_cancel2")
        let btn_chose_prod = document.querySelector(".btn_chose_prod")
        let info_prod1 = document.querySelector(".info_prod1")
        let cnt_image_prd = document.querySelector(".cnt_image_prd")
        let array_imgews = [];
        btn_chose_prod.onclick = () => {
            cnt_menu_prd.classList.add("display");
            cnt_prd_shared.classList.remove("display");
            btn_chose_prod.classList.remove("display");

        }
        function choose_prd() {
            let products = list_prduct.querySelectorAll(".cnt_product");
            products.forEach(
                prd => {
                    prd.onclick = () => {

                        id_product = prd.getAttribute("id");
                        choose_prd_id = id_product;
                        $.post(
                            'select_prod_.php', {
                            id_product: id_product,
                            concept: 'select'
                        }
                        ).done(
                            res => {
                                cnt_menu_prd.classList.remove("display");
                                cnt_prd_shared.classList.add("display");
                                if (window.innerWidth < 1000) {
                                    btn_chose_prod.classList.add("display");
                                }
                                info_prod1.replaceChildren();
                                res = JSON.parse(res);
                                console.log(res);
                                if (typeof (res) == "object") {
                                    array_imgews = [];
                                    for (i of res) {
                                        var imgs = i.des_img.split(',');
                                        for (b of imgs) {
                                            if (b != '') {
                                                array_imgews.push(b);
                                                var cloned_img = cnt_image_prd.cloneNode(true);
                                                cloned_img.querySelector(".img_prd_er").src = b;
                                                cloned_img.classList.add('display')
                                                info_prod1.appendChild(cloned_img);
                                            } else if (b == "") {
                                                var cloned_img = cnt_image_prd.cloneNode(true);
                                                cloned_img.querySelector(".img_prd_er").src = 'img2/no-image.png';
                                                cloned_img.classList.add('display')
                                                info_prod1.appendChild(cloned_img);
                                            }
                                        }
                                        inp_prcie2.value = i.price
                                        input_box.innerHTML = i.description;
                                        etat_prd2.value = i.statu_prd
                                        inp_adress2.value = i.local_product
                                    }
                                    rem_igs(id_product)
                                }
                            }
                        )
                    }
                }
            )
        }

        function rem_igs(id_product) {
            var btn_remove_img = info_prod1.querySelectorAll(".btn_remove_img");
            btn_remove_img.forEach(
                btn => {
                    btn.onclick = () => {

                        let parent = btn.parentNode;
                        let img_to_rem = parent.querySelector('.img_prd_er').getAttribute("src");
                        let new_arr = array_imgews.filter(elem => elem != img_to_rem)
                        confirm_delet.classList.add("display");
                        confirm_delet.querySelector("p").innerHTML = 'Are you sure you want to remove this Images ?'
                        btn_cancel2.onclick = () => confirm_delet.classList.remove("display");
                        btn_sure1.onclick = () => {
                            confirm('des_img', new_arr);
                            confirm_delet.classList.remove("display");
                        }
                    }
                }
            )
        }


        function confirm(item, value) {
            value = JSON.stringify(value);
            $.post(
                'select_prod_.php', {
                id_product: choose_prd_id,
                concept: 'update',
                item: item,
                value: value
            }
            ).done(
                res => {
                    if (item == "available") {
                        setTimeout(
                            () => {
                                window.location.reload();
                            }, 500
                        )

                    }

                    info_prod1.replaceChildren();
                    res = JSON.parse(res);
                    if (typeof (res) == "object") {
                        choose_prd_id = i.id_product;
                        array_imgews = [];
                        for (i of res) {
                            var imgs = i.des_img.split(',');
                            for (b of imgs) {
                                if (b != '') {
                                    array_imgews.push(b);
                                    var cloned_img = cnt_image_prd.cloneNode(true);
                                    cloned_img.querySelector(".img_prd_er").src = b;
                                    cloned_img.classList.add('display')
                                    info_prod1.appendChild(cloned_img);
                                }
                            }
                            inp_prcie2.value = i.price
                            input_box.innerHTML = i.description;
                            etat_prd2.value = i.statu_prd
                            inp_adress2.value = i.local_product
                        }

                        rem_igs(id_product)
                    }

                }
            )
        }


    </script>
</body>

</html>